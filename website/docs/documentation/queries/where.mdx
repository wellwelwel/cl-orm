---
sidebar_position: 5
---

import TabItem from '@theme/TabItem';
import Tabs from '@theme/Tabs';

# WHERE Clauses

The **WHERE** clause is essential for filtering records in `SELECT`, `UPDATE`, and `DELETE` operations.<br/>
With **CL ORM**, you can use the [**OP**](/docs/category/operators) object to construct complex queries efficiently.

The operator names **eq**, **ne**, **gt**, **lt**, **gte** and **lte** are inspired by [**Sequelize**](https://sequelize.org/docs/v6/core-concepts/model-querying-basics/#operators).<br />
See all available operators [**here**](/docs/category/operators).

> The following examples apply as well to **SELECT**, **UPDATE** and **DELETE**.

## Single condition

<Tabs>
  <TabItem value='OP' default>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: eq('id', 15),
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Manual'>

```ts
// highlight-start
import { useD1 } from 'cl-orm';

const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: '`id` = ?',
  params: [15],
  // highlight-start
});
// highlight-end
```

  </TabItem>
</Tabs>

> SQL Query

```sql
-- highlight-start
SELECT * FROM users
-- highlight-end
WHERE `id` = ?

-- params [15]
```

<hr />

## Object shorthand

You can use a plain object as a shorthand for multiple equality conditions combined with `AND`.

<Tabs>
  <TabItem value='Object' default>

```ts
// highlight-start
import { useD1 } from 'cl-orm';

const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: { status: 'active', role: 'admin' },
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Manual'>

```ts
// highlight-start
import { useD1 } from 'cl-orm';

const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: '`status` = ? AND `role` = ?',
  params: ['active', 'admin'],
  // highlight-start
});
// highlight-end
```

  </TabItem>
</Tabs>

> SQL Query

```sql
-- highlight-start
SELECT * FROM users
-- highlight-end
WHERE `status` = ? AND `role` = ?

-- params ['active', 'admin']
```

- Each key becomes a column and each value becomes the parameter, using equality (`=`).
- All conditions are joined with `AND`.

<hr />

## Multiple conditions

Ensure to use **AND**, **OR**, **XOR** between each condition.

<Tabs>
  <TabItem value='OP.AND' default>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { AND, in: IN, eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: AND(IN('id', [15, 30]), eq('status', 1)),
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Array'>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { in: IN, eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: [IN('id', [15, 30]), 'AND', eq('status', 1)],
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Manual'>

```ts
// highlight-start
import { useD1 } from 'cl-orm';

const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: '`id` IN (?, ?) AND `status` = ?',
  params: [15, 30, 1],
  // highlight-start
});
// highlight-end
```

  </TabItem>
</Tabs>

> SQL Query

```sql
-- highlight-start
SELECT * FROM users
-- highlight-end
WHERE `id` IN (?, ?) AND `status` = ?

-- params [15, 30, 1]
```

<hr />

## Combine conditions

Ensure to use **AND**, **OR**, **XOR** between each combination.

<Tabs>
  <TabItem value='OP.OR' default>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { OR, lt, eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: OR(lt('age', 18), eq('status', 'locked')),
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Array'>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { lt, eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: [[lt('age', 18)], 'OR', [eq('status', 'locked')]],
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Manual'>

```ts
// highlight-start
import { useD1 } from 'cl-orm';

const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: '(`age` < ?) OR (`status` = ?)',
  params: [18, 'locked'],
  // highlight-start
});
// highlight-end
```

  </TabItem>
</Tabs>

> SQL Query

```sql
-- highlight-start
SELECT * FROM users
-- highlight-end
WHERE (`age` < ?) OR (`status` = ?)

-- params [18, 'locked']
```

<hr />

## Combine multiple conditions

Ensure to use **AND**, **OR**, **XOR** between each condition and combination.

<Tabs>
  <TabItem value='OP.AND + OP.OR' default>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { OR, AND, gte, lt, eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: OR(
    AND(gte('age', 18), eq('status', 'locked')),
    AND(lt('age', 18), eq('status', 'enabled'))
  ),
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Array'>

```ts
// highlight-start
import { OP, useD1 } from 'cl-orm';

const { gte, lt, eq } = OP;
const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: [
    [gte('age', 18), 'AND', eq('status', 'locked')],
    'OR',
    [lt('age', 18), 'AND', eq('status', 'enabled')],
  ],
  // highlight-start
});
// highlight-end
```

  </TabItem>
  <TabItem value='Manual'>

```ts
// highlight-start
import { useD1 } from 'cl-orm';

const db = useD1(env.DB);

await db.select({
  from: 'users',
  // highlight-end
  where: '(`age` >= ? AND `status` = ?) OR (`age` < ? AND `status` = ?)',
  params: [18, 'locked', 18, 'enabled'],
  // highlight-start
});
// highlight-end
```

  </TabItem>
</Tabs>

> SQL Query

```sql
-- highlight-start
SELECT * FROM users
-- highlight-end
WHERE (`age` >= ? AND `status` = ?) OR (`age` < ? AND `status` = ?);

-- params [18, 'locked', 18, 'enabled']
```

- You can play into depth with combined conditions by encapsulating your conditions in an array. But note that this can become complex.
